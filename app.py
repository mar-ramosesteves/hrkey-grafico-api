@app.route('/grafico', methods=['POST'])
def gerar_grafico():
    try:
        dados = request.json
        print("üì• Dados recebidos:", dados)

        if dados.get('tipo') == 'demo':
            # Simula√ß√£o est√°tica
            arquetipos = ['Estrat√©gico', 'Inspirador', 'Anal√≠tico', 'Executor']
            valores = [85, 70, 60, 90]
        elif dados.get('tipo') == 'real':
            email = dados.get('emailLider')
            periodo = dados.get('periodo')

            print("üîé Procurando dados reais para:", email, "no per√≠odo", periodo)

            # Aqui entra o c√≥digo real de consulta (exemplo abaixo simula)
            arquetipos = ['Estrat√©gico', 'Inspirador', 'Anal√≠tico', 'Executor']
            valores = [88, 72, 63, 91]  # ‚Üê Substitua por consulta real no futuro
        else:
            return "Tipo de gr√°fico inv√°lido", 400

        print("‚úÖ Arquetipos:", arquetipos)
        print("‚úÖ Valores:", valores)

        plt.figure(figsize=(10, 6))
        plt.bar(arquetipos, valores, color='skyblue')
        plt.xlabel('Arqu√©tipos')
        plt.ylabel('Pontua√ß√£o')
        plt.title('Gr√°fico de Arqu√©tipos')
        plt.tight_layout()

        img = io.BytesIO()
        plt.savefig(img, format='png')
        img.seek(0)
        plt.close()

        return send_file(img, mimetype='image/png')

    except Exception as e:
        print("‚ùå Erro ao gerar gr√°fico:", str(e))
        return f"Erro ao gerar gr√°fico: {str(e)}", 500


